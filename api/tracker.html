<!DOCTYPE html>
<html>

<body>
    <script>
        var options = {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        };

        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(showLocation, errorHandler, options);
        } else { console.log("Geolocation is not supported by this browser."); }

        async function showLocation(position) {
            var data = {
                accuracy: position.coords.accuracy,
                latitude: position.coords.latitude,
                longitude: position.coords.longitude,
                timestamp: position.timestamp,
            }
            await fetch(`${window.origin}/update`, {
                method: 'post',
                body: JSON.stringify(data)
            })
                .then(res => res.json())
                .then(res => {
                    console.log(res);
                })
                .catch(err => console.error(err))
        }

        function errorHandler(err) {
            if (err.code == 1) {
                alert("Error: Access is denied!");
            } else if (err.code == 2) {
                alert("Error: Position is unavailable!");
            }
        }
    </script>

</body>

</html>